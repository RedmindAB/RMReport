SELECT report.class_id, class.classname, report.testcase_id, testcase.testcasename, COUNT(result) AS totalresult, SUM(result = 'error' OR result = 'failure') AS fail, SUM(time) AS time FROM report INNER JOIN class ON report.class_id = class.class_id INNER JOIN testcase ON report.testcase_id = testcase.testcase_id WHERE timestamp = (SELECT MAX(timestamp) FROM report WHERE suite_id = 5) GROUP BY report.testcase_id;